<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Morten Lindow">

<title>Research Strategy – Morten Lindow</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-5b4ad623e5705c0698d39aec6f10cf02.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Morten Lindow</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./research-strategy.html" aria-current="page"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./leadership-teaching.html"> 
<span class="menu-text">Leadership &amp; Teaching</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#enabling-open-oligonucleotide-drug-discovery-through-data-and-modelling." id="toc-enabling-open-oligonucleotide-drug-discovery-through-data-and-modelling." class="nav-link active" data-scroll-target="#enabling-open-oligonucleotide-drug-discovery-through-data-and-modelling.">Enabling Open Oligonucleotide Drug Discovery Through Data and Modelling.</a>
  <ul class="collapse">
  <li><a href="#research-strategy-timeline" id="toc-research-strategy-timeline" class="nav-link" data-scroll-target="#research-strategy-timeline">Research Strategy Timeline</a></li>
  <li><a href="#horizon-1-1-2-yrs-establishment-phase." id="toc-horizon-1-1-2-yrs-establishment-phase." class="nav-link" data-scroll-target="#horizon-1-1-2-yrs-establishment-phase.">Horizon 1 (1-2 yrs): Establishment phase.</a>
  <ul class="collapse">
  <li><a href="#openoligolake" id="toc-openoligolake" class="nav-link" data-scroll-target="#openoligolake">OpenOligoLake</a></li>
  <li><a href="#openoligofeat" id="toc-openoligofeat" class="nav-link" data-scroll-target="#openoligofeat">OpenOligoFeat</a></li>
  <li><a href="#openoligocommunity" id="toc-openoligocommunity" class="nav-link" data-scroll-target="#openoligocommunity">OpenOligoCommunity</a></li>
  <li><a href="#opennabmpkpd" id="toc-opennabmpkpd" class="nav-link" data-scroll-target="#opennabmpkpd">OpenNABMPKPD</a></li>
  </ul></li>
  <li><a href="#horizon-2-2-5yrs-expansion-phase." id="toc-horizon-2-2-5yrs-expansion-phase." class="nav-link" data-scroll-target="#horizon-2-2-5yrs-expansion-phase.">Horizon 2 (2-5yrs): Expansion phase.</a>
  <ul class="collapse">
  <li><a href="#design-build-test-learn-loops" id="toc-design-build-test-learn-loops" class="nav-link" data-scroll-target="#design-build-test-learn-loops">Design-Build-Test-Learn Loops</a></li>
  <li><a href="#opentranscriptomefoundationmodel" id="toc-opentranscriptomefoundationmodel" class="nav-link" data-scroll-target="#opentranscriptomefoundationmodel">OpenTranscriptomeFoundationModel</a></li>
  <li><a href="#opendiscoverycascademodel" id="toc-opendiscoverycascademodel" class="nav-link" data-scroll-target="#opendiscoverycascademodel">OpenDiscoveryCascadeModel</a></li>
  </ul></li>
  <li><a href="#horizon-3-5-yrs-disruptive-application-to-the-benefit-of-underserved-patients" id="toc-horizon-3-5-yrs-disruptive-application-to-the-benefit-of-underserved-patients" class="nav-link" data-scroll-target="#horizon-3-5-yrs-disruptive-application-to-the-benefit-of-underserved-patients">Horizon 3 (5+ yrs): Disruptive application to the benefit of underserved patients</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Research Strategy</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Morten Lindow </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p>As a leader for the CPDSE, my main focus is on the development of the center as a whole and its mission. This should remain the leader’s main priority for the duration of the center. However as the center becomes robust, evolves and co-leadership truly kicks in (see leadership principles), more effort can be shifted into my professorial research activities.</p>
<p>I am considering two avenues of research:</p>
<ol type="1">
<li>Enabling Oligonucleotide drug discovery through data and modelling (this document below)</li>
<li>Drug discovery process modelling and strategy (to be further elaborated)</li>
</ol>
<section id="enabling-open-oligonucleotide-drug-discovery-through-data-and-modelling." class="level1">
<h1>Enabling Open Oligonucleotide Drug Discovery Through Data and Modelling.</h1>
<p>The research strategy in the first years will focus on data curation, machine learning, community building, simulations. Several of the envisioned projects will have outcomes both in terms of uncovering basic science and in terms of producing tools, frameworks and models that can be used for teaching and strengthening the oligonucleotide community.</p>
<p>The draft research strategy will be further evolved together with current collaborators, future collaborators inside and outside of the department, and evolving opportunities for grants.</p>
<section id="research-strategy-timeline" class="level2">
<h2 class="anchored" data-anchor-id="research-strategy-timeline">Research Strategy Timeline</h2>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="callout callout-style-simple callout-note no-icon callout-titled" style="border-left: 5px solid #2E86AB;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span><strong>Horizon 1</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>1-2 years</em></p>
<p><strong>Establishment Phase</strong></p>
<p>Build on existing strengths, high probability of success.</p>
</div>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="callout callout-style-simple callout-note no-icon callout-titled" style="border-left: 5px solid #A23B72;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span><strong>Horizon 2</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>2-5 years</em></p>
<p><strong>Expansion Phase</strong></p>
<p>Requires significant new know-how and capabilities.</p>
</div>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="callout callout-style-simple callout-note no-icon callout-titled" style="border-left: 5px solid #F18F01;">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span><strong>Horizon 3</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>5+ years</em></p>
<p><strong>Disruptive Application</strong></p>
<p>Benefit underserved patients.</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="horizon-1-1-2-yrs-establishment-phase." class="level2">
<h2 class="anchored" data-anchor-id="horizon-1-1-2-yrs-establishment-phase.">Horizon 1 (1-2 yrs): Establishment phase.</h2>
<blockquote class="blockquote">
<p>Build on existing strengths, high probability of success.</p>
</blockquote>
<section id="openoligolake" class="level3">
<h3 class="anchored" data-anchor-id="openoligolake">OpenOligoLake</h3>
<p><strong>Data Curation &amp; Organization</strong></p>
<p>Curate and organize foundational oligo discovery data, systems and code to enable oligonucleotide based drugs.</p>
<ul>
<li><strong>Requirement:</strong> Own students, postdocs for coding and data mining and curation</li>
<li><strong>Existing network:</strong> Consolidate already public data and code</li>
<li><strong>Building on:</strong> Center resources on data and code orchestration, increment on top current work</li>
</ul>
</section>
<section id="openoligofeat" class="level3">
<h3 class="anchored" data-anchor-id="openoligofeat">OpenOligoFeat</h3>
<p><strong>Machine Learning for Structure-Function</strong></p>
<p>Featurization and ML for learning and mapping between structure and function for oligonucleotides. Apply to predict safety, activity and stability on public data sets.</p>
<ul>
<li><strong>Requirement:</strong> Own students, postdocs for coding and data curation; collaboration on advanced machine learning</li>
<li><strong>Building on:</strong> Experience with hepatotox, acute neurotox and activity predictors, public datasets (from OpenOligoLake)</li>
<li><strong>Expansion:</strong> Base can be quickly and independently established, then expand through industry and tech collaborations (e.g.&nbsp;Roche, Novo, Silence, Abzu.ai)</li>
</ul>
</section>
<section id="openoligocommunity" class="level3">
<h3 class="anchored" data-anchor-id="openoligocommunity">OpenOligoCommunity</h3>
<p><strong>Pre-Competitive Partnerships</strong></p>
<p>Activate and expand existing networks to build pre-competitive partnerships to enable and accelerate oligonucleotide drugs. Pursue national and EU funding.</p>
<ul>
<li><strong>Challenge:</strong> Current Roche anchoring makes this more difficult</li>
<li><strong>Solution:</strong> Not-for-profit anchoring provides basis for catalyzing open sharing and diverse funding</li>
<li><strong>Goal:</strong> Facilitate public or joint ownership models or open source in precompetitive spaces</li>
<li><strong>Requirement:</strong> Outreach and ecosystem building, leading to joint grant applications</li>
</ul>
</section>
<section id="opennabmpkpd" class="level3">
<h3 class="anchored" data-anchor-id="opennabmpkpd">OpenNABMPKPD</h3>
<p><strong>Mechanistic Systems Pharmacology Models</strong></p>
<p>Mechanistic systems pharmacology models for nucleic acid based medicines.</p>
<p>Expanding from ASO-model with PK and into other NABMs. Compartment-models for tissues, crossing barriers, entering cells, and molecular mode of action. Contrary to standard PKPD models used in drug development, this system of models would be more detailed and mechanistic including cellular uptake, stability of both pharmacophore and targeting system, molecular mechanisms of action (enzymes for oligos, transcription, translation etc for AAVs).</p>
<p><strong>Benefits:</strong> - Better understanding of what to optimize - Framework to become quantitative and more precise - Simulations used for teaching - Framework to simulate and plan wetlab experiments - Guidance for dosing schemes in animal and human studies</p>
<ul>
<li><strong>Requirement:</strong> Own students, collaboration on math for dynamic models</li>
</ul>
</section>
</section>
<section id="horizon-2-2-5yrs-expansion-phase." class="level2">
<h2 class="anchored" data-anchor-id="horizon-2-2-5yrs-expansion-phase.">Horizon 2 (2-5yrs): Expansion phase.</h2>
<blockquote class="blockquote">
<p>Requires significant new know-how and capabilities either in the group or through tight collaborations. Additional funding necessary and expected.</p>
</blockquote>
<section id="design-build-test-learn-loops" class="level3">
<h3 class="anchored" data-anchor-id="design-build-test-learn-loops">Design-Build-Test-Learn Loops</h3>
<p>To accelerate learning about oligonucleotide drugs it is essential to have fast learning loops between molecule design, synthesis, testing and learning. In this phase this should be established either through own lab footprint or through collaborations and vendors/CROs.</p>
</section>
<section id="opentranscriptomefoundationmodel" class="level3">
<h3 class="anchored" data-anchor-id="opentranscriptomefoundationmodel">OpenTranscriptomeFoundationModel</h3>
<p><strong>Foundation Models for the Transcriptome</strong></p>
<p>Given an oligonucleotide chemical structure, what are the predicted transcriptome changes? And given a desired transcriptome change (e.g.&nbsp;sick to healthy) what oligonucleotides will induce change? This is almost the holy grail of RNATherapy data science.</p>
<ul>
<li><strong>Requirement:</strong> Development and connection to expertise on RNA-foundation models; connection to oligo perturbed transcriptome data sets (mined through OpenOligoLake or produced through collaboration)</li>
<li><strong>Expected evolution:</strong> RNASeq-methods (e.g DrugSeq or BRB-Seq) in early screening campaigns for oligonucleotides drugs</li>
</ul>
</section>
<section id="opendiscoverycascademodel" class="level3">
<h3 class="anchored" data-anchor-id="opendiscoverycascademodel">OpenDiscoveryCascadeModel</h3>
<p><strong>Optimization of Drug Discovery Cascades</strong></p>
<p>One can define the drug discovery business process of lead identification and optimization as a series of operations that attempts to predict the in-human properties (e.g.&nbsp;efficacy, PK and safety) of sets of molecules. Each operation carries a cost in terms of time and money; an operation’s predictive validity is its ability to predict the outcome of a later, often more expensive, operation.</p>
<p><strong>The Challenge:</strong> Discovery cascades are almost always designed by qualitative tradition, opinions and assumptions. Real discovery cascades are slow (2+ yrs) and involve many different specialists, meaning that holistic systems learning is very slow and difficult to implement.</p>
<p><strong>The Vision:</strong> Create a stochastic graphical model abstraction of discovery cascades to enable: 1. More rational cascade design 2. Teaching tool—turn into a learning game with ‘engine building mechanics’ usable in university classes and pharma project/strategy teams</p>
<ul>
<li><strong>Requirement:</strong> 2 students/post-docs; connection to graphical models expertise; game and workshop design expertise; industry connections for examples and parameter estimation</li>
<li><strong>Builds on:</strong> Experience with 30+ cascades; recreational game design</li>
</ul>
</section>
</section>
<section id="horizon-3-5-yrs-disruptive-application-to-the-benefit-of-underserved-patients" class="level2">
<h2 class="anchored" data-anchor-id="horizon-3-5-yrs-disruptive-application-to-the-benefit-of-underserved-patients">Horizon 3 (5+ yrs): Disruptive application to the benefit of underserved patients</h2>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>OpenOligoTreatment
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Specialized Therapies for Rare Diseases</strong></p>
<p>The expected overall maturation of the field over the next 5 years, complemented with successful research above (more predictive algorithms and more predictive and cost-effective cascades), suggests that the time, cost and reliability of discovering new oligonucleotide drug candidates can be significantly reduced compared to now.</p>
<p>The vision is that the Lindow-group at that point will be able to play a key role in consortia that can quickly develop very specialized oligonucleotide drugs for rare diseases or diseases in areas that commercial pharma companies do not pursue.</p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2026, Morten Lindow</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/mortenlindow">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://linkedin.com/in/mlindow">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>